{"SerieHistoricaDesistencia": "\nSELECT uf.ano_saida, uf.status, count(*) FROM ufc AS uf\n    WHERE uf.status = 'Cancelado' AND uf.ano_saida !='xx'\nGROUP BY uf.ano_saida, uf.status;\n", "TootipsSerieHistoricaDesistencia": "\nSELECT uf.nome_unidade, count(*) FROM ufc AS uf\n    WHERE uf.status = 'Cancelado' AND uf.ano_saida !='xx' AND CAST(uf.ano_saida AS INT) = ano1 \nGROUP BY uf.ano_saida, uf.nome_unidade \nORDER BY count DESC\nLIMIT 5;\n", "Forma de entrada": "\nSELECT u.status, u.forma_ingresso, count(*) FROM ufc AS u\n    WHERE u.status LIKE ANY (ARRAY['%%d1%%', '%%d2%%', '%%d3%%', '%%d4%%']) AND\n          u.ano_ingresso   BETWEEN ano1_ and ano2_ AND\n          u.forma_ingresso LIKE ANY (ARRAY['%%c1%%', '%%c2%%'])\n    GROUP BY u.status, forma_ingresso;\n", "PorSexo": "\nSELECT u.sexo, u.forma_ingresso, u.status, count(*) FROM ufc AS u\n    WHERE u.status LIKE ANY (ARRAY['%%d1%%', '%%d2%%', '%%d3%%', '%%d4%%']) AND\n          u.ano_ingresso   BETWEEN ano1_ and ano2_ AND\n          u.forma_ingresso LIKE ANY (ARRAY['%%c1%%', '%%c2%%'])\n    GROUP BY u.sexo, forma_ingresso, u.status;\n", "MediaAprovados": "\nSELECT uf.status, uf.forma_ingresso, ROUND(AVG(ABS(uf.ano_ingresso - CAST( uf.ano_saida AS BIGINT))), 2) AS media FROM ufc as uf\n    WHERE uf.ano_saida != 'xx' AND\n        uf.ano_ingresso   BETWEEN ano1_ and ano2_ AND\n        uf.forma_ingresso LIKE ANY (ARRAY['%%c1%%', '%%c2%%'])\n    GROUP BY uf.status, uf.forma_ingresso;\n    ", "TaxaCancelados": "\nWITH tabela AS (\n    SELECT u.nome_curso, count(u.status)::FLOAT AS total FROM ufc AS u\n        WHERE u.ano_ingresso BETWEEN ano1_ and ano2_ AND\n              u.forma_ingresso LIKE ANY (ARRAY['%%c1%%', '%%c2%%'])\n    GROUP BY u.nome_curso\n),\n tabela2 AS (\n    SELECT u.nome_curso, count(*)::FLOAT AS desistencia FROM ufc AS u\n        WHERE u.status = 'Cancelado' AND\n              u.ano_ingresso BETWEEN ano1_ and ano2_ AND \n              u.forma_ingresso LIKE ANY (ARRAY['%%c1%%', '%%c2%%'])\n    GROUP BY u.nome_curso\n) SELECT t1.nome_curso, ROUND((t2.desistencia / t1.total)::DECIMAL*100 , 2) AS taxa_cancelamento FROM tabela AS t1\n    INNER JOIN tabela2 AS t2\n        ON t1.nome_curso = t2.nome_curso\n    ORDER BY taxa_cancelamento DESC LIMIT 10;\n", "CancelamentoMatricularModalidade": "\nSELECT  CAST(u.ano_saida AS INT), u.nome_mobilidadade_considerada, u.modalidade_considerada, count(*) FROM ufc AS u\n    WHERE u.nome_mobilidadade_considerada !='xx' AND\n          u.status = 'Cancelado' AND\n          u.ano_saida !='xx'\n    GROUP BY CAST(u.ano_saida AS INT), u.nome_mobilidadade_considerada, u.modalidade_considerada;\n", "TempoCancelamento": "\nWITH tabela AS (\n    SELECT ABS(CAST(u.ano_ingresso AS INT) - CAST(u.ano_saida AS INT)) AS anos, u.nome_mobilidadade_considerada, u.modalidade_considerada, count(*) FROM ufc AS u\n        WHERE u.nome_mobilidadade_considerada !='xx' AND\n              u.status = 'Cancelado' AND\n              u.ano_saida !='xx'\n        GROUP BY anos, u.nome_mobilidadade_considerada, u.modalidade_considerada\n) SELECT CASE \n    WHEN anos = 0 THEN 'No mesmo ano'  \n    WHEN anos = 1 THEN 'Primeiro ano'\n    WHEN anos = 2 THEN 'Segundo ano'\n    WHEN anos = 3 THEN 'Terceiro ano'\n    WHEN anos = 4 THEN 'Quarto ano'\n    WHEN anos = 5 THEN 'Quinto ano'\n    ELSE 'Sexto ano'\nEND ano_de_cancelamento, nome_mobilidadade_considerada, modalidade_considerada, count\nFROM tabela;\n"}